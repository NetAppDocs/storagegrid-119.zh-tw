---
permalink: ilm/create-ilm-rule-define-placements.html 
sidebar: sidebar 
keywords: ilm rule step 2, define placements 
summary: 建立 ILM 規則精靈的定義放置步驟可讓您定義放置指令，以確定物件的儲存時間、副本類型（複製或擦除編碼）、儲存位置和副本數量。 
---
= 第 2 步（共 3 步）：定義展示位置
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
建立 ILM 規則精靈的「定義放置」步驟可讓您定義放置指令，以確定物件的儲存時間、副本類型（複製或擦除編碼）、儲存位置和副本數量。


NOTE: 所顯示的螢幕截圖只是範例。您的結果可能會因您的StorageGRID版本而異。

.關於此任務
一個 ILM 規則可以包含一個或多個放置指令。每個安置指示適用於一個時間段。當您使用多條指令時，時間段必須連續，並且至少有一條指令必須從第 0 天開始。指令可以一直持續下去，或直到您不再需要任何物件副本。

如果您想要建立不同類型的副本或在該時間段內使用不同的位置，則每個放置指令可以有多行。

在此範例中，第一年，ILM 規則在網站 1 中儲存複製副本，在網站 2 中儲存複製副本。一年後，將製作一份 2+1 擦除編碼副本並僅保存在一個網站。

image::../media/ilm_create_ilm_rule_wizard_2.png[建立 ILM 規則精靈步驟 2]

.步驟
. 對於*參考時間*，選擇計算安置指令的開始時間時所使用的時間類型。
+
[cols="1a,2a"]
|===
| 選項 | 描述 


 a| 
攝取時間
 a| 
物體被吞食的時間。



 a| 
上次訪問時間
 a| 
上次檢索（讀取或檢視）物件的時間。

若要使用此選項，必須為 S3 儲存桶啟用上次存取時間更新。請參閱link:using-last-access-time-in-ilm-rules.html["在 ILM 規則中使用上次存取時間"] 。



 a| 
使用者定義建立時間
 a| 
使用者定義元資料中指定的時間。



 a| 
非當前時間
 a| 
如果您在“僅將此規則套用至較舊的物件版本（在啟用了版本控制的 S3 儲存桶中）？”問題中選擇了“是”，則會自動選擇“非目前時間”。link:create-ilm-rule-enter-details.html["建立 ILM 規則精靈的第 1 步"] 。

|===
+
如果您想要建立一個_合規_規則，您必須選擇*攝取時間*。請參閱link:managing-objects-with-s3-object-lock.html["使用 S3 對象鎖管理對象"] 。

. 在「*時間段和展示位置*」部分中，輸入第一個時間段的開始時間和持續時間。
+
例如，您可能想要指定第一年儲存物件的位置（從第 0 天開始儲存 365 天）。至少有一條指令必須從第 0 天開始。

. 如果您想要建立複製副本：
+
.. 從*以以下方式儲存物件*下拉清單中，選擇*複製*。
.. 選擇您要影印的份數。
+
如果將副本數量變更為 1，則會出現警告。任何時間段內僅建立一個複製副本的 ILM 規則會使資料面臨永久遺失的風險。請參閱link:why-you-should-not-use-single-copy-replication.html["為什麼不應該使用單一副本複製"] 。

+
為了避免風險，請執行以下一項或多項操作：

+
*** 增加該時間段內的副本數量。
*** 將副本新增至其他儲存池或雲端儲存池。
*** 選擇*擦除編碼*而不是*複製*。
+
如果此規則已經為所有時間段建立了多個副本，您可以放心地忽略此警告。



.. 在*副本位於*欄位中，選擇要新增的儲存池。
+
*如果您只指定一個儲存池*，請注意StorageGRID只能在任何給定的儲存節點上儲存物件的複製副本。如果您的網格包含三個儲存節點，並且您選擇 4 作為副本數，則只會製作三個副本 - 每個儲存節點一個副本。

+
觸發「無法實現 ILM 放置」警報，表示無法完全套用 ILM 規則。

+
*如果指定多個儲存池*，請記住以下規則：

+
*** 副本數不能大於儲存池數。
*** 如果副本數等於儲存池數，則每個儲存池中都會儲存該物件的副本。
*** 如果副本數量少於儲存池數量，則在攝取網站儲存一份副本，然後系統分發剩餘的副本以保持池之間的磁碟使用平衡，同時確保沒有網站取得物件的多份副本。
*** 如果儲存池重疊（包含相同的儲存節點），則物件的所有副本可能僅保存在一個網站上。因此，請勿指定所有儲存節點儲存池（StorageGRID 11.6 及更早版本）和另一個儲存池。




. 如果您想要建立擦除編碼副本：
+
.. 從*以以下方式儲存物件*下拉清單中，選擇*擦除編碼*。
+

NOTE: 擦除編碼最適合大於 1 MB 的物件。不要對小於 200 KB 的物件使用擦除編碼，以避免管理非常小的擦除編碼片段的開銷。

.. 如果您沒有新增大於 200 KB 的物件大小篩選器，請選擇 *上一個步驟* 返回步驟 1。然後，選擇*新增進階篩選器*並將*物件大小*篩選器設定為大於 200 KB 的任何值。
.. 選擇要新增的儲存池和要使用的擦除編碼方案。
+
擦除編碼副本的儲存位置包括擦除編碼方案的名稱，後面跟著儲存池的名稱。

+
可用的擦除編碼方案受您選擇的儲存池中的儲存節點數量的限制。一個 `Recommended`徽章出現在提供以下任何一個方案的旁邊link:../ilm/what-erasure-coding-schemes-are.html["最佳保護或最低儲存開銷"]。



. 可選：
+
.. 選擇*新增其他類型或位置*以在不同位置建立其他副本。
.. 選擇*新增另一個時間段*來新增不同的時間段。
+
[NOTE]
====
物件刪除基於以下設定：

*** 除非另一個時間段以*永遠*結束，否則物件會在最後一個時間段結束時自動刪除。
*** 根據link:../ilm/example-8-priorities-for-s3-bucket-lifecycle-and-ilm-policy.html#example-of-bucket-lifecycle-taking-priority-over-ilm-policy["儲存桶和租用戶保留期設置"]，即使 ILM 保留期結束，物件也可能不會被刪除。


====


. 如果要將物件儲存在雲端儲存池中：
+
.. 在「*以下列方式儲存物件*」下拉清單中，選擇「*複製*」。
.. 選擇「*副本於*」字段，然後選擇一個雲端儲存池。
+
使用雲端儲存池時，請記住以下規則：

+
*** 您無法在單一放置說明中選擇多個雲端儲存池。同樣，您不能在同一個放置指令中選擇雲端儲存池和儲存池。
*** 您只能在任何給定的雲端儲存池中儲存一個物件的副本。如果將 *Copies* 設定為 2 或更多，則會出現錯誤訊息。
*** 您不能同時在任何雲端儲存池中儲存多個物件副本。如果使用雲端儲存池的多個展示位置的日期重疊，或者同一展示位置中的多條線路使用雲端儲存池，則會出現錯誤訊息。
*** 您可以將物件儲存在雲端儲存池中，同時將該物件作為複製或擦除編碼副本儲存在StorageGRID中。但是，您必須在時間段的放置說明中包含多行，以便可以指定每個位置的副本數量和類型。




. 在保留圖中，確認您的放置說明。
+
在此範例中，第一年，ILM 規則在網站 1 中儲存複製副本，在網站 2 中儲存複製副本。一年後以及接下來的十年內，將在三個網站上保存 6+3 擦除編碼副本。總共 11 年後，這些物件將從StorageGRID中刪除。

+
保留圖的規則分析部分指出：

+
** StorageGRID站點遺失保護將在此規則有效期內適用。
** 依照此規則處理的物件將在第 4015 天後被刪除。
+
請參閱link:using-multiple-storage-pools-for-cross-site-replication.html["啟用網站遺失保護。"]

+
image::../media/ilm_rule_retention_diagram.png[ILM 規則保留圖]



. 選擇*繼續*。link:create-ilm-rule-select-ingest-behavior.html["步驟 3（選擇攝取行為）"]出現建立 ILM 規則精靈。

