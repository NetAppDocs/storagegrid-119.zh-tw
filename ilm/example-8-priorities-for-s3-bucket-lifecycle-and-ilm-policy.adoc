---
permalink: ilm/example-8-priorities-for-s3-bucket-lifecycle-and-ilm-policy.html 
sidebar: sidebar 
keywords: retention priority, example S3 bucket lifecycle, example ILM policy 
summary: 根據您的生命週期配置，物件遵循 S3 儲存桶生命週期或 ILM 策略的保留設定。 
---
= 範例 8：S3 儲存桶生命週期和 ILM 策略的優先級
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
根據您的生命週期配置，物件遵循 S3 儲存桶生命週期或 ILM 策略的保留設定。



== 儲存桶生命週期優先於 ILM 策略的範例

ILM 策略::
+
--
* 基於非目前時間參考的規則：在第 0 天，保留 X 個副本 20 天
* 基於攝取時間參考的規則（預設）：第 0 天，保留 X 個副本 50 天


--
儲存桶生命週期:: `"Filter": {"Prefix": "docs/"}, "Expiration": {"Days": 100}, "NoncurrentVersionExpiration": {"NoncurrentDays": 5}`
結果::
+
--
* 一個名為“docs/text”的物件被攝取。它與“docs/”前綴的儲存桶生命週期過濾器相符。
+
** 100 天后，將建立一個刪除標記，並且「docs/text」將變為非目前版本。
** 5 天后，即自攝取以來共 105 天，「docs/text」被刪除。
** 95 天后，即自攝取以來總共 200 天，自建立刪除標記以來 100 天，過期的刪除標記將被刪除。


* 一個名為「video/movie」的物件被攝取。它與過濾器不匹配並使用 ILM 保留策略。
+
** 50 天后，將創建一個刪除標記，並且「視訊/電影」將不再有效。
** 20 天后，即自攝取以來共 70 天，「影片/電影」將被刪除。
** 30 天后，自攝取以來共 100 天，自建立刪除標記以來共 50 天，過期的刪除標記將被刪除。




--




== bucket 生命週期隱式永久保存的範例

ILM 策略::
+
--
* 基於非目前時間參考的規則：在第 0 天，保留 X 個副本 20 天
* 基於攝取時間參考的規則（預設）：第 0 天，保留 X 個副本 50 天


--
儲存桶生命週期:: `"Filter": {"Prefix": "docs/"}, "Expiration": {"ExpiredObjectDeleteMarker": true}`
結果::
+
--
* 一個名為“docs/text”的物件被攝取。它與“docs/”前綴的儲存桶生命週期過濾器相符。
+
這 `Expiration`操作僅適用於過期的刪除標記，這意味著永遠保留其他所有內容（以“docs/”開頭）。

+
以「docs/」開頭的刪除標記在過期時會被刪除。

* 一個名為「video/movie」的物件被攝取。它與過濾器不匹配並使用 ILM 保留策略。
+
** 50 天后，將創建一個刪除標記，並且「視訊/電影」將不再有效。
** 20 天后，即自攝取以來共 70 天，「影片/電影」將被刪除。
** 30 天后，自攝取以來共 100 天，自建立刪除標記以來共 50 天，過期的刪除標記將被刪除。




--




== 使用儲存桶生命週期複製 ILM 並清理過期刪除標記的範例

ILM 策略::
+
--
* 基於非目前時間參考的規則：在第 0 天，保留 X 個副本 20 天
* 基於攝取時間參考的規則（預設）：在第 0 天，永久保留 X 個副本


--
儲存桶生命週期:: `"Filter": {}, "Expiration": {"ExpiredObjectDeleteMarker": true}, "NoncurrentVersionExpiration": {"NoncurrentDays": 20}`
結果::
+
--
* ILM 策略在儲存桶生命週期中重複。
+
** ILM 策略的永久規則旨在手動刪除物件並在 20 天後清理非目前版本。因此，攝取時間規則將永遠保留過期的刪除標記。
** 儲存桶生命週期複製 ILM 策略的行為，同時加入 `"ExpiredObjectDeleteMarker": true`，一旦刪除標記過期，就會將其刪除


* 吞食了物體。無濾波器意味著儲存桶生命週期適用於所有物件並覆蓋 ILM 保留設定。
+
** 當租用戶發出物件刪除請求時，會建立一個刪除標記，並且該物件將變為非目前物件。
** 20 天后，非目前物件將被刪除，並且刪除標記將過期。
** 不久之後，過期的刪除標記就被刪除了。




--

