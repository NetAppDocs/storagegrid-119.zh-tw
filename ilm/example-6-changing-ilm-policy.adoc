---
permalink: ilm/example-6-changing-ilm-policy.html 
sidebar: sidebar 
keywords: change ILM policy, example ILM policy, information lifecycle policy example 
summary: 如果您的資料保護需要變更或新增站點，您可以建立並啟動新的 ILM 策略。 
---
= 範例 6：更改 ILM 策略
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果您的資料保護需要變更或新增站點，您可以建立並啟動新的 ILM 策略。

在變更策略之前，您必須了解 ILM 位置的變更如何暫時影響StorageGRID系統的整體效能。

在此範例中，在擴充功能中新增了一個新的StorageGRID站點，並且需要實施新的活動 ILM 策略以在新站點儲存資料。要實施新的積極政策，首先link:creating-ilm-policy.html["制定政策"]。之後，你必須link:../ilm/creating-ilm-policy.html#simulate-ilm-policy["模擬"]進而link:../ilm/creating-ilm-policy.html#activate-ilm-policy["啟用設定"]新政策。


CAUTION: 以下 ILM 規則和策略僅作為範例。配置 ILM 規則的方法有很多種。在啟動新策略之前，請先進行模擬以確認它能夠如預期運作以保護內容免於遺失。



== 更改 ILM 策略如何影響效能

當您啟動新的 ILM 策略時， StorageGRID系統的效能可能會暫時受到影響，尤其是當新策略中的放置說明要求將許多現有物件移至新位置時。

當您啟動新的 ILM 策略時， StorageGRID會使用它來管理所有對象，包括現有對象和新攝取的對象。在啟動新的 ILM 策略之前，請檢查對現有複製和擦除編碼物件的位置的任何變更。在評估和實施新位置時，更改現有物件的位置可能會導致臨時資源問題。

為了確保新的 ILM 策略不會影響現有複製和糾刪碼物件的放置，您可以link:create-ilm-rule-enter-details.html#use-advanced-filters-in-ilm-rules["建立帶有攝取時間過濾器的 ILM 規則"]。例如，*攝取時間_在_<日期和時間>或之後_*，以便新規則僅適用於在指定日期和時間或之後攝取的物件。

可能暫時影響StorageGRID效能的 ILM 策略變更類型包括：

* 將不同的擦除編碼設定檔套用至現有的擦除編碼物件。
+

NOTE: StorageGRID認為每個擦除編碼設定檔都是唯一的，並且在使用新設定檔時不會重複使用擦除編碼片段。

* 更改現有物件所需的副本類型；例如，將大量複製的物件轉換為擦除編碼物件。
* 將現有物件的副本移至完全不同的位置；例如，將大量物件移入或移出雲端儲存池或遠端站點。




== 主動 ILM 策略範例 6：兩個站點的資料保護

在此範例中，活動 ILM 策略最初是為雙站點StorageGRID系統設計的，並使用兩個 ILM 規則。

image::../media/policy_6_active_policy.png[範例 ILM 策略 6 活動策略]

在此 ILM 策略中，屬於租用戶 A 的物件在單一站點受到 2+1 擦除編碼的保護，而屬於所有其他租用戶的物件則在兩個站點上使用 2 副本複製進行保護。



=== 規則 1：租戶 A 的單一站點擦除編碼

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
租戶 A 的單一站點擦除編碼



 a| 
租戶帳戶
 a| 
租戶A



 a| 
儲存池
 a| 
站點 1



 a| 
展示位置
 a| 
站點 1 從第 0 天到永遠採用 2+1 擦除編碼

|===


=== 規則 2：其他租戶的雙站點複製

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
其他租戶的雙站點複製



 a| 
租戶帳戶
 a| 
忽略



 a| 
儲存池
 a| 
站點 1 和站點 2



 a| 
展示位置
 a| 
從第 0 天到永遠的兩個副本：一個副本在站點 1，一個副本在站點 2。

|===


== ILM 策略範例 6：三個站點的資料保護

在此範例中，ILM 策略將被三站點StorageGRID系統的新策略取代。

在執行擴充功能以新增網站後，網格管理員建立了兩個新的儲存池：一個用於網站 3 的儲存池和一個包含所有三個網站的儲存池（與所有儲存節點預設儲存池不同）。然後，管理員建立了兩個新的 ILM 規則和一個新的 ILM 策略，旨在保護所有三個網站的資料。

當啟動此新的 ILM 策略時，屬於租戶 A 的物件將在三個站點受到 2+1 擦除編碼的保護，而屬於其他租戶的物件（以及屬於租戶 A 的較小物件）將使用 3 個副本複製在三個站點受到保護。



=== 規則 1：租用戶 A 的三站點擦除編碼

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
租戶 A 的三站點擦除編碼



 a| 
租戶帳戶
 a| 
租戶A



 a| 
儲存池
 a| 
所有 3 個站點（包括站點 1、站點 2 和站點 3）



 a| 
展示位置
 a| 
從第 0 天到永遠，在所有 3 個站點採用 2+1 擦除編碼

|===


=== 規則 2：其他租戶的三個站點複製

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
其他租戶的三站點複製



 a| 
租戶帳戶
 a| 
忽略



 a| 
儲存池
 a| 
站點 1、站點 2 和站點 3



 a| 
展示位置
 a| 
從第 0 天到永遠的三個複製副本：站點 1 處一個副本、站點 2 處一個副本、站點 3 處一個副本。

|===


== 激活 ILM 策略範例 6

當您啟動新的 ILM 策略時，現有物件可能會被移至新位置，或者可能會根據任何新規則或更新規則中的放置說明為現有物件建立新的物件副本。


CAUTION: ILM 策略中的錯誤可能會導致無法復原的資料遺失。在啟動策略之前，請仔細檢查並模擬該策略，以確認其能夠如預期般發揮作用。


CAUTION: 當您啟動新的 ILM 策略時， StorageGRID會使用它來管理所有對象，包括現有對象和新攝取的對象。在啟動新的 ILM 策略之前，請檢查對現有複製和擦除編碼物件的位置的任何變更。在評估和實施新位置時，更改現有物件的位置可能會導致臨時資源問題。



=== 當擦除編碼指令改變時會發生什麼

在此範例的目前活動的 ILM 策略中，屬於租用戶 A 的物件在網站 1 使用 2+1 擦除編碼進行保護。在新的 ILM 策略中，屬於租用戶 A 的物件將在網站 1、2 和 3 使用 2+1 擦除編碼進行保護。

當新的 ILM 策略啟動時，會發生以下 ILM 操作：

* 租戶 A 攝取的新物件被分成兩個資料片段，並新增一個奇偶校驗片段。然後，將這三個片段分別儲存在不同的網站。
* 在正在進行的 ILM 掃描過程中，將重新評估屬於租戶 A 的現有物件。由於 ILM 放置指令使用了新的擦除編碼設定文件，因此會建立全新的擦除編碼片段並將其分發到三個網站。
+

NOTE: 站點 1 中現有的 2+1 片段不會重複使用。  StorageGRID認為每個擦除編碼設定檔都是唯一的，並且在使用新設定檔時不會重複使用擦除編碼片段。





=== 當複製指令改變時會發生什麼

在本例中目前活動的 ILM 策略中，使用站點 1 和 2 的儲存池中的兩個副本來保護屬於其他租用戶的物件。在新的 ILM 策略中，屬於其他租戶的物件將使用站點 1、2 和 3 的儲存池中的三個副本進行保護。

當新的 ILM 策略啟動時，會發生以下 ILM 操作：

* 當租用戶 A 以外的任何租用戶接收新物件時， StorageGRID會建立三個副本並在每個站點保存一份副本。
* 在正在進行的 ILM 掃描過程中，將重新評估屬於這些其他租戶的現有物件。由於站點 1 和站點 2 上的現有物件副本繼續滿足新 ILM 規則的複製要求，因此StorageGRID只需要為站點 3 建立該物件的新副本。




=== 啟動此策略對效能的影響

當本例中的 ILM 策略啟動時，此StorageGRID系統的整體效能將受到暫時影響。需要高於正常水平的網格資源來為租戶 A 的現有物件建立新的擦除編碼片段，並在站點 3 為其他租戶的現有物件建立新的複製副本。

由於 ILM 策略的改變，客戶端的讀寫請求可能會暫時遇到高於正常的延遲。當佈局指令在整個網格中完全實施後，延遲將恢復到正常水平。

為了避免在啟動新的 ILM 策略時出現資源問題，您可以在任何可能更改大量現有物件位置的規則中使用「攝取時間」進階篩選器。將攝取時間設定為大於或等於新政策生效的大致時間，以確保現有物件不會被不必要地移動。


NOTE: 如果您需要在 ILM 策略變更後減慢或加快物件處理的速度，請聯絡技術支援。
