---
permalink: monitor/creating-custom-alert-rules.html 
sidebar: sidebar 
keywords: how to create custom alert rules 
summary: 您可以建立自訂警報規則來定義觸發警報的條件。 
---
= 建立自訂警報規則
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以建立自訂警報規則來定義觸發警報的條件。

.開始之前
* 您已使用link:../admin/web-browser-requirements.html["支援的網頁瀏覽器"]。
* 你有link:../admin/admin-group-permissions.html["管理警報或 Root 存取權限"]。
* 您熟悉link:commonly-used-prometheus-metrics.html["常用的 Prometheus 指標"]。
* 你明白 https://prometheus.io/docs/prometheus/latest/querying/basics/["Prometheus 查詢的語法"^]。
* 或者，您已經觀看了影片： https://netapp.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=54af90c4-9a38-4136-9621-b1ff008604a3["影片：自訂警報"^] 。
+
[link=https://netapp.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=54af90c4-9a38-4136-9621-b1ff008604a3]
image::../media/video-screenshot-alert-create-custom-118.png[影片：自訂警報]



.關於此任務
StorageGRID不驗證自訂警報。如果您決定建立自訂警報規則，請遵循以下一般準則：

* 查看預設警報規則的條件，並將其用作自訂警報規則的範例。
* 如果為警報規則定義多個條件，請對所有條件使用相同的表達式。然後，改變每個條件的閾值。
* 仔細檢查每個條件是否有拼字錯誤和邏輯錯誤。
* 僅使用網格管理 API 中列出的指標。
* 當使用網格管理 API 測試表達式時，請注意「成功」回應可能是空的回應主體（未觸發警報）。若要查看警報是否已真正觸發，您可以暫時將閾值設為您預計目前為真的值。
+
例如，測試表達式 `node_memory_MemTotal_bytes < 24000000000`，先執行 `node_memory_MemTotal_bytes >= 0`並確保獲得預期的結果（所有節點都傳回一個值）。然後，將運算符和閾值改回預期值並再次執行。沒有結果表示此表達式目前沒有警報。

* 除非您已驗證警報是否在預期時觸發，否則不要假設自訂警報正在起作用。


.步驟
. 選擇*警報* > *規則*。
+
出現「警報規則」頁面。

. 選擇*建立自訂規則*。
+
出現「建立自訂規則」對話方塊。

+
image::../media/alerts_create_custom_rule.png[警報 > 建立自訂規則]

. 選取或清除「*已啟用*」核取方塊以確定此警報規則目前是否已啟用。
+
如果停用警報規則，則不會評估其表達式，也不會觸發任何警報。

. 輸入以下資訊：
+
[cols="1a,2a"]
|===
| 場地 | 描述 


 a| 
唯一名稱
 a| 
此規則的唯一名稱。警報規則名稱顯示在警報頁面上，也是電子郵件通知的主題。警報規則的名稱長度可以為 1 到 64 個字元。



 a| 
描述
 a| 
正在發生的問題的描述。該描述是警報頁面和電子郵件通知中顯示的警報訊息。警報規則的描述長度可以為 1 到 128 個字元。



 a| 
建議措施
 a| 
可選地，當觸發此警報時建議採取的操作。以純文字輸入建議的操作（無格式代碼）。警報規則的建議操作可以介於 0 到 1,024 個字元之間。

|===
. 在條件部分中，輸入一個或多個警報嚴重性等級的 Prometheus 表達式。
+
基本表達式通常具有以下形式：

+
`[metric] [operator] [value]`

+
表達式可以是任意長度，但在使用者介面中只出現在一行上。至少需要一個表達式。

+
如果節點安裝的 RAM 數量少於 24,000,000,000 位元組（24 GB），則此表達式會觸發警報。

+
`node_memory_MemTotal_bytes < 24000000000`

+
若要查看可用指標並測試 Prometheus 表達式，請選擇幫助圖示image:../media/icon_nms_question.png["問號圖示"]並按照連結進入網格管理 API 的指標部分。

. 在「*持續時間*」欄位中，輸入觸發警報之前條件必須持續有效的時間量，然後選擇一個時間單位。
+
若要在條件成立時立即觸發警報，請輸入 *0*。增加此值以防止臨時情況觸發警報。

+
預設值為 5 分鐘。

. 選擇*儲存*。
+
對話方塊關閉，新的自訂警報規則出現在警報規則表中。


