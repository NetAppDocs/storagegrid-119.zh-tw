---
permalink: maintain/adding-to-or-changing-subnet-lists-on-grid-network.html 
sidebar: sidebar 
keywords: storagegrid, subnet list, grid network 
summary: 您可以使用變更 IP 工具在網格網路中新增或變更子網路。 
---
= 在網格網路上新增或變更子網路列表
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用變更 IP 工具在網格網路中新增或變更子網路。

.開始之前
* 你有 `Passwords.txt`文件。


您可以在網格網路子網路清單中新增、刪除或變更子網路。變化將影響網格中所有節點的路由。


NOTE: 如果您僅對網格網路子網路清單進行更改，請使用網格管理器新增或變更網路配置。否則，如果由於網路配置問題而無法存取網格管理器，或者您同時執行網格網路路由變更和其他網路更改，請使用變更 IP 工具。

[NOTE]
====
請勿將包含下列 IPv4 位址的子網路用於任何節點的網格網路、管理網路或用戶端網路：

* 192,168,130,101
* 192,168,131,101
* 192,168,130,102
* 192,168,131,102
* 198.51.100.2
* 198.51.100.4


例如，不要對任何節點的網格網路、管理網路或客戶端網路使用下列子網路範圍：

* 192.168.130.0/24，因為此子網路範圍包含 IP 位址 192.168.130.101 和 192.168.130.102
* 192.168.131.0/24，因為此子網路範圍包含 IP 位址 192.168.131.101 和 192.168.131.102
* 198.51.100.0/24，因為此子網路範圍包含 IP 位址 198.51.100.2 和 198.51.100.4


====
.步驟
. 登入主管理節點：
+
.. 輸入以下命令： `ssh admin@_primary_Admin_Node_IP_`
.. 輸入 `Passwords.txt`文件。
.. 輸入以下命令切換到root： `su -`
.. 輸入 `Passwords.txt`文件。


+
當您以 root 身分登入時，提示字元將從 `$`到 `#`。

. 輸入以下命令啟動更改 IP 工具： `change-ip`
. 在提示符號下輸入設定密碼。
+
出現主選單。

+
image::../media/change_ip_tool_main_menu.png[螢幕截圖顯示了更改 IP 工具的歡迎螢幕]

. 在主選單上，選擇編輯電網子網路的選項（選項*4*）。
+

NOTE: 電網子網路清單的變更是整個電網範圍內的。

. 選擇下列選項之一：
+
--
** 輸入以下命令新增子網路： `add CIDR`
** 輸入以下命令刪除子網路： `del CIDR`
** 輸入以下命令設定子網路清單： `set CIDR`


--
+
--

NOTE: 對於所有命令，您可以使用以下格式輸入多個位址： `add CIDR, CIDR`

例子： `add 172.14.0.0/16, 172.15.0.0/16, 172.16.0.0/16`


TIP: 您可以使用「向上箭頭」將先前輸入的值呼叫到目前輸入提示中，然後在必要時對其進行編輯，從而減少所需的輸入量。

下面的範例輸入顯示了為網格網路子網路清單設定子網路：

image::../media/change_ip_tool_gnsl_sample_input.gif[螢幕截圖由周圍文字描述]

--
. 準備好後，輸入 *q* 返回主選單畫面。您的變更將保留，直到被清除或套用為止。
. 選擇下列選項之一：
+
** 選擇選項 *5* 以在隔離的輸出中顯示編輯，僅顯示變更的項目。變更以綠色（新增）或紅色（刪除）突出顯示，如下面的範例輸出所示：
+
image::../media/change_ip_tool_gnsl_sample_output.gif[螢幕截圖由周圍文字描述]

** 選擇選項 *6* 以在顯示完整配置的輸出中顯示編輯。變更以綠色（新增）或紅色（刪除）突出顯示。
+

NOTE: 某些命令列介面可能會使用刪除線格式顯示新增和刪除的內容。



. 選擇選項 *7* 來驗證所有階段性變更。
+
此驗證可確保遵守網格、管理和客戶端網路的規則，例如使用重疊子網路。

. 或者，選擇選項 *8* 儲存所有階段性變更並稍後返回繼續進行變更。
+
此選項可讓您退出更改 IP 工具並稍後重新啟動，而不會遺失任何未套用的變更。

. 執行下列操作之一：
+
** 如果您想要清除所有變更而不儲存或套用新的網路配置，請選擇選項*9*。
** 如果您準備好套用變更並提供新的網路配置，請選擇選項*10*。在配置期間，輸出顯示套用更新的狀態，如下列範例輸出所示：
+
[listing]
----
Generating new grid networking description file...

Running provisioning...

Updating grid network configuration on Name
----


. 如果在進行電網變更時選擇了選項 *10*，請選擇以下選項之一：
+
** *應用*：立即套用更改，並在必要時自動重啟每個節點。
+
如果新的網路配置將與舊的網路配置同時運行而無需任何外部更改，則可以使用 *apply* 選項進行完全自動化的配置更改。

** *stage*：下次重啟節點時套用變更。
+
如果需要對實體或虛擬網路配置進行更改以使新的網路配置正常運行，則必須使用 *stage* 選項，關閉受影響的節點，進行必要的實體網路更改，然後重新啟動受影響的節點。

+

NOTE: 如果您使用 *stage* 選項，請在暫存後儘快重新啟動節點以盡量減少中斷。

** *取消*：此時不要進行任何網路變更。
+
如果您不知道所提議的變更需要重新啟動節點，您可以推遲變更以盡量減少對使用者的影響。選擇“*取消*”將返回主選單並儲存您的更改，以便您稍後將它們應用。



+
套用或階段變更後，將根據網格配置變更產生新的復原包。

. 如果因錯誤而停止配置，則可以使用下列選項：
+
** 若要終止 IP 變更程序並返回主選單，請輸入 *a*。
** 若要重試失敗的操作，請輸入 *r*。
** 若要繼續下一個操作，請輸入 *c*。
+
可以從主選單中選擇選項 *10*（套用變更）來稍後重試失敗的操作。直到所有操作成功完成後，IP 更改過程才算完成。

** 如果您必須手動幹預（例如重新啟動節點）並且確信工具認為失敗的操作實際上已成功完成，請輸入 *f* 將其標記為成功並轉到下一個操作。


. 從網格管理器下載新的復原套件。
+
.. 選擇*維護* > *系統* > *恢復包*。
.. 輸入配置密碼。


+

CAUTION: 復原包檔案必須是安全的，因為它包含可用於從StorageGRID系統取得資料的加密金鑰和密碼。


