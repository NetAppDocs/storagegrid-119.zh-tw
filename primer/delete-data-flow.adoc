---
permalink: primer/delete-data-flow.html 
sidebar: sidebar 
keywords: object, delete, deletion, object lock, bucket lifecycle, expiration, ilm, placement instruction 
summary: 當用戶端或租用戶執行刪除操作或物件的生命週期到期時，所有物件副本都會從StorageGRID系統中刪除，從而觸發其自動刪除。有一個定義的物件刪除資料流。 
---
= 刪除資料流
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
當客戶端執行刪除操作或物件的生命週期到期時，所有物件副本都會從StorageGRID系統中刪除，從而觸發其自動刪除。有一個定義的物件刪除資料流。



== 刪除層次結構

StorageGRID提供了幾種控制何時保留或刪除物件的方法。物件可以根據客戶端請求或自動刪除。  StorageGRID始終優先處理任何 S3 物件鎖定設置，而不是用戶端刪除請求，而用戶端刪除請求又優先於 S3 儲存桶生命週期和 ILM 放置指令。

* *S3 物件鎖定*：如果為網格啟用了全域 S3 物件鎖定設置，S3 用戶端可以建立啟用了 S3 物件鎖定的儲存桶，然後使用 S3 REST API 為新增至該儲存桶的每個物件版本指定保留截止日期和合法保留設定。
+
** 處於合法保留狀態的物件版本無法透過任何方法刪除。
** 在達到物件版本的保留截止日期之前，無法透過任何方法刪除該版本。
** 啟用 S3 物件鎖的儲存桶中的物件將被 ILM「永久」保留。但是，在達到保留期限後，物件版本可能會因客戶端請求或儲存桶生命週期到期而被刪除。
** 如果 S3 用戶端對儲存桶套用預設保留截止日期，則它們不需要為每個物件指定保留截止日期。


* *客戶端刪除請求*：S3 用戶端可以發出刪除物件請求。當客戶端刪除物件時，該物件的所有副本都會從StorageGRID系統中刪除。
* *刪除儲存桶中的物件*：租用戶管理器使用者可以使用此選項從StorageGRID系統永久刪除選定儲存桶中物件和物件版本的所有副本。
* *S3 儲存桶生命週期*：S3 用戶端可以向其儲存桶新增指定到期作業的生命週期配置。如果存在儲存桶生命週期，則當滿足到期作業中指定的日期或天數時， StorageGRID會自動刪除物件的所有副本，除非用戶端先刪除該物件。
* *ILM 放置說明*：假設儲存桶未啟用 S3 物件鎖定且沒有儲存桶生命週期，則當 ILM 規則中的最後一個時間段結束且沒有為該物件指定進一步的放置時， StorageGRID會自動刪除該物件。
+

NOTE: 配置 S3 儲存桶生命週期後，生命週期到期作業將覆寫與生命週期過濾器相符的物件的 ILM 策略。因此，即使放置該物件的任何 ILM 指令已失效，該物件仍可能保留在網格上。



看link:../ilm/how-objects-are-deleted.html["如何刪除對象"]了解更多。



== 客戶端刪除的資料流

image::../media/delete_data_flow.png[客戶端刪除資料流]

. LDR 服務從用戶端應用程式接收刪除請求。
. LDR 服務更新元資料存儲，以便物件在客戶端請求中看起來已被刪除，並指示 ILM 引擎刪除物件資料的所有副本。
. 該物件已從系統中刪除。元資料儲存已更新以刪除物件元資料。




== ILM 刪除的資料流

image::../media/automatic_deletion_data_flow.png[自動刪除資料流]

. ILM引擎確定該物件需要被刪除。
. ILM 引擎通知元資料儲存。元數據儲存更新物件元數據，以便物件在客戶端請求中看起來已被刪除。
. ILM 引擎刪除該物件的所有副本。元資料儲存已更新以刪除物件元資料。

