---
permalink: admin/configure-high-availability-group.html 
sidebar: sidebar 
keywords: how to configure high availability group, node priority order, failover 
summary: 您可以設定高可用性（HA）群組來提供對管理節點或網關節點上的服務的高度可用存取。 
---
= 配置高可用性組
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以設定高可用性 (HA) 群組以提供對管理節點或閘道上的服務的高可用性存取。

.開始之前
* 您已使用link:../admin/web-browser-requirements.html["支援的網頁瀏覽器"]。
* 你有link:admin-group-permissions.html["Root存取權限"]。
* 如果您打算在 HA 群組中使用 VLAN 接口，則您已經建立了 VLAN 介面。看link:../admin/configure-vlan-interfaces.html["配置VLAN介面"] 。
* 如果您打算為 HA 群組中的節點使用存取接口，則您已建立該接口：
+
** *Red Hat Enterprise Linux（安裝節點前）*：link:../rhel/creating-node-configuration-files.html["建立節點設定檔"]
** *Ubuntu 或 Debian（安裝節點之前）*：link:../ubuntu/creating-node-configuration-files.html["建立節點設定檔"]
** *Linux（安裝節點後）*：link:../maintain/linux-adding-trunk-or-access-interfaces-to-node.html["Linux：為節點新增主幹或存取介面"]
** *VMware（安裝節點後）*：link:../maintain/vmware-adding-trunk-or-access-interfaces-to-node.html["VMware：向節點新增中繼或存取介面"]






== 建立高可用性群組

建立高可用性群組時，您可以選擇一個或多個介面並按優先順序組織它們。然後，為該組分配一個或多個 VIP 位址。

介面必須用於網關節點或管理節點才能包含在 HA 群組中。一個 HA 群組只能為任何給定節點使用一個介面；但是，同一節點的其他介面可以在其他 HA 群組中使用。



=== 訪問嚮導

.步驟
. 選擇 *配置* > *網路* > *高可用性群組*。
. 選擇“*創建*”。




=== 輸入 HA 組的詳細信息

.步驟
. 為 HA 組提供唯一的名稱。
. 或者，輸入 HA 組的描述。
. 選擇*繼續*。




=== 將介面加入 HA 組

.步驟
. 選擇一個或多個要新增至此 HA 群組的介面。
+
使用列標題對行進行排序，或輸入搜尋字詞以更快找到介面。

+
image::../media/ha_group_add_interfaces.png[HA 組添加介面]

+

NOTE: 建立 VLAN 介面後，最多等待 5 分鐘，新介面就會出現在表中。

+
.選擇介面的指南
** 您必須至少選擇一個介面。
** 一個節點只能選擇一個介面。
** 如果 HA 群組用於管理節點服務（包括網格管理器和租戶管理器）的 HA 保護，則僅選擇管理節點上的介面。
** 如果 HA 群組用於 S3 用戶端流量的 HA 保護，請選擇管理節點、網關節點或兩者上的介面。
** 如果您選擇不同類型節點上的接口，則會出現一條訊息說明。需要提醒您的是，如果發生故障轉移，先前活動節點提供的服務可能無法在新活動節點上使用。例如，備份網關節點無法為管理節點服務提供 HA 保護。同樣，備份管理節點無法執行主管理節點可以提供的所有維護程序。
** 如果您無法選擇接口，則其複選框將被停用。工具提示提供了更多資訊。
+
image::../media/vlan_parent_interface_tooltip.png[VLAN 介面工具提示]

** 如果某個介面的子網路值或閘道與另一個選取的介面衝突，則您無法選擇該介面。
** 如果配置的介面沒有靜態 IP 位址，則無法選擇該介面。


. 選擇*繼續*。




=== 確定優先順序

如果 HA 群組包含多個接口，您可以確定哪個是主接口，哪些是備份（故障轉移）接口。如果主介面發生故障，VIP 位址將移至可用的最高優先權介面。如果該接口發生故障，VIP 位址將移至下一個可用的最高優先權接口，依此類推。

.步驟
. 拖曳「優先順序」列中的行來決定主介面和任何備份介面。
+
清單中的第一個介面是主介面。除非發生故障，否則主介面是活動介面。

+
image::../media/ha_group_determine_failover.png[HA 組決定優先順序]

+

TIP: 如果 HA 群組提供對網格管理器的存取權限，則必須選擇主管理節點上的一個介面作為主介面。某些維護程序只能從主管理節點執行。

. 選擇*繼續*。




=== 輸入 IP 位址

.步驟
. 在 *Subnet CIDR* 欄位中，以 CIDR 表示法指定 VIP 子網路－IPv4 位址後面接著斜槓和子網路長度（0-32）。
+
網路位址不得設定任何主機位元。例如，  `192.16.0.0/22` 。

+

NOTE: 如果使用32位元前綴，VIP網路位址也充當網關位址和VIP位址。

+
image::../media/ha_group_select_virtual_ips.png[HA 團體進入 VIP]

. 或者，如果任何 S3 管理或租用戶用戶端將從不同的子網路存取這些 VIP 位址，請輸入 *網關 IP 位址*。網關位址必須在 VIP 子網路內。
+
用戶端和管理員用戶將使用此網關存取虛擬 IP 位址。

. 為 HA 組中的活動介面輸入至少一個、最多十個 VIP 位址。所有 VIP 位址都必須位於 VIP 子網路內，並且所有 VIP 位址都將在活動介面上同時處於活動狀態。
+
您必須提供至少一個 IPv4 位址。您也可以選擇指定其他 IPv4 和 IPv6 位址。

. 選擇*建立 HA 群組*並選擇*完成*。
+
HA 群組已創建，您現在可以使用配置的虛擬 IP 位址。





=== 後續步驟Next steps

如果您將使用此 HA 群組進行負載平衡，請建立負載平衡器端點以決定連接埠和網路協定並附加任何所需的憑證。看link:configuring-load-balancer-endpoints.html["配置負載平衡器端點"] 。



== 編輯高可用性群組

您可以編輯高可用性 (HA) 群組以變更其名稱和描述、新增或刪除介面、變更優先順序或新增或更新虛擬 IP 位址。

例如，如果您想要在網站或節點退役過程中刪除與選定介面關聯的節點​​，則可能需要編輯 HA 群組。

.步驟
. 選擇 *配置* > *網路* > *高可用性群組*。
+
高可用性組頁面顯示所有現有的 HA 組。

. 選取要編輯的 HA 群組的複選框。
. 根據您要更新的內容執行以下操作之一：
+
** 選擇*動作* > *編輯虛擬 IP 位址*來新增或刪除 VIP 位址。
** 選擇*操作* > *編輯 HA 群組*來更新群組的名稱或描述、新增或刪除介面、變更優先順序或新增或刪除 VIP 位址。


. 如果您選擇了「編輯虛擬 IP 位址」：
+
.. 更新 HA 群組的虛擬 IP 位址。
.. 選擇*儲存*。
.. 選擇*完成*。


. 如果您選擇了「編輯 HA 群組」：
+
.. 或者，更新群組的名稱或描述。
.. 或者，選擇或清除複選框來新增或刪除介面。
+

NOTE: 如果 HA 群組提供對網格管理器的存取權限，則必須選擇主管理節點上的一個介面作為主介面。某些維護程序只能從主管理節點執行

.. 或者，拖曳行來變更此 HA 群組的主介面和任何備份介面的優先權順序。
.. 或者，更新虛擬 IP 位址。
.. 選擇*儲存*，然後選擇*完成*。






== 刪除高可用性群組

您可以一次刪除一個或多個高可用性 (HA) 群組。


TIP: 如果 HA 群組綁定到負載平衡器端點，則無法刪除它。若要刪除 HA 群組，您必須將其從使用它的任何負載平衡器端點中刪除。

為防止用戶端中斷，請在刪除 HA 群組之前更新任何受影響的 S3 用戶端應用程式。更新每個用戶端以使用另一個 IP 位址進行連接，例如，不同 HA 群組的虛擬 IP 位址或在安裝期間為介面配置的 IP 位址。

.步驟
. 選擇 *配置* > *網路* > *高可用性群組*。
. 檢查要刪除的每個 HA 群組的 *負載平衡器端點* 列。如果列出了任何負載平衡器端點：
+
.. 前往 *配置* > *網路* > *負載平衡器端點*。
.. 選取端點的複選框。
.. 選擇*操作* > *編輯端點綁定模式*。
.. 更新綁定模式以刪除 HA 群組。
.. 選擇“儲存變更”。


. 如果沒有列出負載平衡器端點，請選取要刪除的每個 HA 群組的核取方塊。
. 選擇*操作* > *刪除 HA 群組*。
. 查看訊息並選擇*刪除 HA 群組*以確認您的選擇。
+
您選擇的所有 HA 組都將刪除。高可用性群組頁面上會出現綠色的成功橫幅。


